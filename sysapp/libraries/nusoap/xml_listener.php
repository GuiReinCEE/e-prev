<?php	class XMLListener	{		var $err    = "";		var $fnc    = "";		var $aviso  = "";		var $arrLen = "";		var $linhas = Array();				function getXML()		{			$ret = "<response>";            $ret.= $this->fnc;						if (trim($this->err) != "") 			{				$ret.= $this->err;			}		    else			{				$ret.= '<fld tp="SYS" id="ERR">NULL</fld>';			}						$nr_fim = count($this->arrLen);			if ($nr_fim > 0)			{				$nr_conta = 0;				while($nr_conta < $nr_fim)				{					$ret.= $this->linhas[$nr_conta];					$nr_conta++;				}			}   			if (trim($this->aviso) != "")			{				$ret.= $this->aviso;			}			$ret.= "</response>";   			return $ret;		}			function addDat($piFldName, $piFldValue)		{			$this->arrLen = $this->arrLen + 1;			$this->linhas[] = '<fld tp="DAT" id="'.$piFldName.'">'.$piFldValue.'</fld>';		}			function addDatList($piFldName, $piFldValue, $piFldDescription, $piFieldSelected)		{			$this->arrLen = $this->arrLen + 1;			if (strtoupper($piFieldSelected) <> "S")			{				$piFieldSelected = "FALSE";			}			else			{				$piFieldSelected = "TRUE";			}						$this->linhas[] = '<fld tp="LST" id="'.$piFldName.'" value="'.$piFldValue.'" selected="'.$piFieldSelected.'">'.$piFldDescription.'</fld>';		}			function addAviso($piAviso)		{			$this->aviso.= '<fld tp="SYS" id="WRN">'.$piAviso.'</fld>';		}			function addErr($piErr)		{			$this->err = '<fld tp="SYS" id="ERR">'.$piErr.'</fld>';		}		function appendText($piTxt)		{			$this->arrLen = $this->arrLen + 1;			$this->linhas[] = $piTxt;		}		function addManualTag($tag)		{			$this->arrLen = $this->arrLen + 1;			$this->linhas[] = $tag;		}		function addFnc($piFncName)		{			$this->fnc = '<fld tp="SYS" id="FNC">'.$piFncName.'</fld>';		}	}?>